import{db,doc,getDoc}from"/js/firebaseConfig.js";class MagicTooltip{constructor(e){this.trigger=e,this.init()}async init(){await this.fetchContent(),this.setupEvents()}async fetchContent(){try{const t=`magicKomponen/magicInfoTambahan/${this.trigger.dataset.category}/${this.trigger.dataset.document}`,n=doc(db,t),e=await getDoc(n);e.exists()&&(this.content=e.data().contentStatic,this.createTooltip())}catch(e){console.error("Error fetching tooltip:",e)}}createTooltip(){this.tooltip=document.createElement("div"),this.tooltip.className="magic-tooltip",this.tooltip.id=this.trigger.getAttribute("aria-describedby"),this.tooltip.setAttribute("role","tooltip"),this.tooltip.innerHTML=this.content,document.body.appendChild(this.tooltip),this.positionTooltip()}positionTooltip(){const e=this.trigger.getBoundingClientRect(),t=this.tooltip.getBoundingClientRect();switch(this.trigger.dataset.position){case"top":this.tooltip.style.top=`${e.top-t.height-10}px`,this.tooltip.style.left=`${e.left+e.width/2-t.width/2}px`;break;case"bottom":this.tooltip.style.top=`${e.bottom+10}px`,this.tooltip.style.left=`${e.left+e.width/2-t.width/2}px`;break;case"left":this.tooltip.style.left=`${e.left-t.width-10}px`,this.tooltip.style.top=`${e.top+e.height/2-t.height/2}px`;break;case"right":this.tooltip.style.left=`${e.right+10}px`,this.tooltip.style.top=`${e.top+e.height/2-t.height/2}px`;break;default:this.tooltip.style.top=`${e.bottom+10}px`,this.tooltip.style.left=`${e.left+e.width/2-t.width/2}px`}}show(){this.tooltip.classList.add("visible")}hide(){this.tooltip.classList.remove("visible")}toggle(){this.tooltip.classList.toggle("visible")}setupEvents(){switch(this.trigger.dataset.trigger){case"hover":this.trigger.addEventListener("mouseenter",()=>this.show()),this.trigger.addEventListener("mouseleave",()=>this.hide());break;case"click":this.trigger.addEventListener("click",e=>{e.preventDefault(),this.toggle()});break;case"focus":this.trigger.addEventListener("focus",()=>this.show()),this.trigger.addEventListener("blur",()=>this.hide());break}this.trigger.addEventListener("keydown",e=>{e.key==="Escape"&&this.hide()})}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".magic-trigger").forEach(e=>{new MagicTooltip(e)})})