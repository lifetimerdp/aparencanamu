import{auth,db,doc,setDoc,getDoc,onSnapshot}from"/js/firebaseConfig.js";class MagicNav{constructor(){this.navElement=document.querySelector(".magic-nav"),this.init()}async init(){await this.initializeFirebase(),this.setupEventListeners()}async initializeFirebase(){if(this.user=auth.currentUser,!this.user)return;this.koleksi=this.navElement.dataset.koleksi,this.kolom=this.navElement.dataset.kolom,this.dokumenId=this.navElement.dataset.dokumen||this.user.uid,this.docRef=doc(db,"magicKomponen",this.koleksi,"pengguna",this.dokumenId),await this.initializeDocument(),this.setupRealtimeUpdates()}async initializeDocument(){const e=await getDoc(this.docRef);e.exists()||await setDoc(this.docRef,{metadata:{userId:this.user.uid,createdAt:new Date},[this.kolom]:{items:[{label:"Beranda",url:"/"},{label:"Tentang",url:"/tentang"}]}})}setupRealtimeUpdates(){onSnapshot(this.docRef,e=>{const t=e.data();t&&t[this.kolom]&&this.renderMenu(t[this.kolom].items)})}renderMenu(e){const t=document.getElementById("magicNavMenu");t.innerHTML=e.map(e=>`
      <a href="${e.url}" class="magic-nav-link">${e.label}</a>
    `).join("")}setupEventListeners(){document.querySelector(".magic-nav-toggle").addEventListener("click",()=>{document.getElementById("magicNavMenu").classList.toggle("active")})}}auth.onAuthStateChanged(e=>{e&&new MagicNav})